{"ast":null,"code":"var _jsxFileName = \"/Users/nguyenhuuan/Documents/GitHub/citizenV/frontend/src/views/Analysis/GenderAnalysis/NewPyramid.js\";\nimport * as React from 'react';\nimport Paper from '@material-ui/core/Paper';\nimport { connect } from 'react-redux';\nimport { Chart, BarSeries, Title, ArgumentAxis, ValueAxis, Legend } from '@devexpress/dx-react-chart-material-ui';\nimport { Animation, ArgumentScale, ValueScale } from '@devexpress/dx-react-chart';\nimport { scaleBand } from 'd3-scale';\nimport { withStyles } from '@material-ui/core/styles';\nimport Button from '@mui/material/Button';\nimport TextField from '@mui/material/TextField'; //import {filterCitizensFunc} from './filterCitizensFunc';\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst legendStyles = {\n  root: {\n    display: 'flex',\n    margin: 'auto',\n    flexDirection: 'row'\n  }\n};\n\nconst legendLabelStyles = theme => ({\n  label: {\n    paddingTop: theme.spacing(1)\n  }\n});\n\nconst legendItemStyles = {\n  item: {\n    flexDirection: 'column'\n  }\n};\n\nconst LegendRootBase = ({\n  classes,\n  ...restProps\n}) => /*#__PURE__*/_jsxDEV(Legend.Root, { ...restProps,\n  className: classes.root\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 43,\n  columnNumber: 3\n}, this);\n\n_c = LegendRootBase;\n\nconst LegendLabelBase = ({\n  classes,\n  ...restProps\n}) => /*#__PURE__*/_jsxDEV(Legend.Label, { ...restProps,\n  className: classes.label\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 46,\n  columnNumber: 3\n}, this);\n\n_c2 = LegendLabelBase;\n\nconst LegendItemBase = ({\n  classes,\n  ...restProps\n}) => /*#__PURE__*/_jsxDEV(Legend.Item, { ...restProps,\n  className: classes.item\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 49,\n  columnNumber: 3\n}, this);\n\n_c3 = LegendItemBase;\nconst LegendRoot = withStyles(legendStyles, {\n  name: 'LegendRoot'\n})(LegendRootBase);\nconst LegendLabel = withStyles(legendLabelStyles, {\n  name: 'LegendLabel'\n})(LegendLabelBase);\nconst LegendItem = withStyles(legendItemStyles, {\n  name: 'LegendItem'\n})(LegendItemBase);\n\nconst Label = ({\n  text,\n  ...props\n}) => /*#__PURE__*/_jsxDEV(ValueAxis.Label, { ...props,\n  text: `${Math.abs(text)}%`\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 56,\n  columnNumber: 3\n}, this);\n\n_c4 = Label;\n\nconst modifyDomain = ([start, end]) => {\n  const threshold = Math.ceil(Math.max(Math.abs(start), Math.abs(end)));\n  return [-threshold, threshold];\n};\n\nclass NewPyramid extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.handleChange = e => {\n      this.setState({ ...this.state,\n        year: e.target.value\n      });\n    };\n\n    this.handleClick = () => {\n      const {\n        citizens,\n        filterListAnalysis\n      } = this.props;\n      const result = filterListAnalysis.length > 0 ? this.caculateData(this.filterCitizensFunc(citizens, filterListAnalysis), this.state.year) : this.caculateData(citizens, this.state.year);\n      this.setState({ ...this.state,\n        data: [...result]\n      });\n    };\n\n    this.extractCitizensByAge = (citizens, from, to, year) => {\n      let a = citizens.filter(element => {\n        return year - element.dob.slice(0, 4) >= from && year - element.dob.slice(0, 4) <= to;\n      });\n      let countBoys = 0;\n      let countGirls = 0;\n      a.forEach(element => {\n        element.gender === \"male\" ? countBoys++ : countGirls++;\n      });\n      return {\n        age: `${from}-${to}`,\n        male: countBoys * -1 / 5,\n        female: countGirls / 5\n      };\n    };\n\n    this.caculateData = (citizens, year) => {\n      let result = [];\n\n      for (let i = 0; i < 90; i = i + 5) {\n        let element = this.extractCitizensByAge(citizens, i, i + 4, year);\n        result.push(element);\n      }\n\n      return result;\n    };\n\n    this.filterCitizensFunc = (citizens, filterListAnalysis) => {\n      let filteredCitizens = [];\n      let filterListId = filterListAnalysis.map(e => e.id);\n      filteredCitizens = citizens.filter(e => {\n        for (let i = 0; i < filterListId.length; i++) {\n          if (e.village_id.search(filterListId[i]) !== -1) {\n            return true;\n          }\n        }\n      });\n      return filteredCitizens;\n    };\n\n    this.state = {\n      data: [],\n      year: \"2019\"\n    };\n  }\n\n  componentDidMount() {\n    const {\n      citizens,\n      filterListAnalysis\n    } = this.props;\n    const result = filterListAnalysis.length > 0 ? this.caculateData(this.filterCitizensFunc(citizens, filterListAnalysis), this.state.year) : this.caculateData(citizens, this.state.year);\n    this.setState({ ...this.state,\n      data: [...result]\n    });\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.citizens != this.props.citizens || prevProps.filterListAnalysis != this.props.filterListAnalysis) {\n      const result = this.props.filterListAnalysis.length > 0 ? this.caculateData(this.filterCitizensFunc(this.props.citizens, this.props.filterListAnalysis), this.state.year) : this.caculateData(this.props.citizens, this.state.year);\n      this.setState({ ...this.state,\n        data: [...result]\n      });\n    }\n  }\n\n  render() {\n    const {\n      data,\n      year\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Paper, {\n        style: {\n          height: \"567px\"\n        },\n        children: /*#__PURE__*/_jsxDEV(Chart, {\n          style: {\n            height: \"100%\"\n          },\n          data: data,\n          rotated: true,\n          children: [/*#__PURE__*/_jsxDEV(ArgumentScale, {\n            factory: scaleBand\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(ArgumentAxis, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(ValueScale, {\n            modifyDomain: modifyDomain\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(BarSeries, {\n            name: \"Nam\",\n            valueField: \"male\",\n            argumentField: \"age\",\n            color: \"#3F7FBF\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(BarSeries, {\n            name: \"N\\u1EEF\",\n            valueField: \"female\",\n            argumentField: \"age\",\n            color: \"#F87CCC\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(Title, {\n            text: \"Th\\xE1p d\\xE2n s\\u1ED1\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(Animation, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 174,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(Legend, {\n            position: \"bottom\",\n            rootComponent: LegendRoot,\n            itemComponent: LegendItem,\n            labelComponent: LegendLabel\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.year,\n        children: [/*#__PURE__*/_jsxDEV(TextField, {\n          id: \"standard-basic\",\n          label: \"Nh\\u1EADp n\\u0103m\",\n          variant: \"outlined\",\n          size: \"small\",\n          onChange: this.handleChange,\n          value: year\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: this.handleClick,\n          variant: \"contained\",\n          children: \"Ph\\xE2n t\\xEDch\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 9\n    }, this);\n  }\n\n}\n\nconst mapStatesToProps = state => {\n  return {\n    citizens: state.citizens.citizens,\n    filterListAnalysis: state.citizens.filterListAnalysis\n  };\n};\n\nexport default connect(mapStatesToProps, null)(NewPyramid);\nconst styles = {\n  year: {\n    display: \"flex\",\n    justifyContent: \"center\",\n    background: \"white\",\n    gap: \"1rem\",\n    paddingBottom: \"1rem\",\n    borderBottomLeftRadius: \"10px\",\n    borderBottomRightRadius: \"10px\"\n  }\n};\nconst data = [{\n  age: '0-4',\n  male: -4.9,\n  female: 4.3\n}, {\n  age: '5-9',\n  male: -4.4,\n  female: 4.2\n}, {\n  age: '10-14',\n  male: -4.2,\n  female: 4.0\n}, {\n  age: '15-19',\n  male: -4.0,\n  female: 3.8\n}, {\n  age: '20-24',\n  male: -3.9,\n  female: 3.7\n}, {\n  age: '25-29',\n  male: -4.0,\n  female: 3.8\n}, {\n  age: '30-34',\n  male: -4.0,\n  female: 3.8\n}, {\n  age: '35-39',\n  male: -3.5,\n  female: 3.4\n}, {\n  age: '40-44',\n  male: -3.2,\n  female: 3.1\n}, {\n  age: '45-49',\n  male: -3.1,\n  female: 3.1\n}, {\n  age: '50-54',\n  male: -2.8,\n  female: 2.8\n}, {\n  age: '55-59',\n  male: -2.4,\n  female: 2.5\n}, {\n  age: '60-64',\n  male: -2.0,\n  female: 2.1\n}, {\n  age: '65-69',\n  male: -1.6,\n  female: 1.8\n}, {\n  age: '70-74',\n  male: -1.1,\n  female: 1.2\n}, {\n  age: '75-79',\n  male: -0.7,\n  female: 0.9\n}, {\n  age: '80-84',\n  male: -0.4,\n  female: 0.6\n}, {\n  age: '85-89',\n  male: -0.2,\n  female: 0.3\n}, {\n  age: '90+',\n  male: -0.1,\n  female: 0.1\n}];\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"LegendRootBase\");\n$RefreshReg$(_c2, \"LegendLabelBase\");\n$RefreshReg$(_c3, \"LegendItemBase\");\n$RefreshReg$(_c4, \"Label\");","map":{"version":3,"sources":["/Users/nguyenhuuan/Documents/GitHub/citizenV/frontend/src/views/Analysis/GenderAnalysis/NewPyramid.js"],"names":["React","Paper","connect","Chart","BarSeries","Title","ArgumentAxis","ValueAxis","Legend","Animation","ArgumentScale","ValueScale","scaleBand","withStyles","Button","TextField","legendStyles","root","display","margin","flexDirection","legendLabelStyles","theme","label","paddingTop","spacing","legendItemStyles","item","LegendRootBase","classes","restProps","LegendLabelBase","LegendItemBase","LegendRoot","name","LegendLabel","LegendItem","Label","text","props","Math","abs","modifyDomain","start","end","threshold","ceil","max","NewPyramid","PureComponent","constructor","handleChange","e","setState","state","year","target","value","handleClick","citizens","filterListAnalysis","result","length","caculateData","filterCitizensFunc","data","extractCitizensByAge","from","to","a","filter","element","dob","slice","countBoys","countGirls","forEach","gender","age","male","female","i","push","filteredCitizens","filterListId","map","id","village_id","search","componentDidMount","componentDidUpdate","prevProps","render","height","styles","mapStatesToProps","justifyContent","background","gap","paddingBottom","borderBottomLeftRadius","borderBottomRightRadius"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport Paper from '@material-ui/core/Paper';\nimport { connect } from 'react-redux';\nimport {\n  Chart,\n  BarSeries,\n  Title,\n  ArgumentAxis,\n  ValueAxis,\n  Legend,\n} from '@devexpress/dx-react-chart-material-ui';\nimport {\n  Animation,\n  ArgumentScale,\n  ValueScale,\n} from '@devexpress/dx-react-chart';\nimport { scaleBand } from 'd3-scale';\nimport { withStyles } from '@material-ui/core/styles';\nimport Button from '@mui/material/Button';\nimport TextField from '@mui/material/TextField';\n//import {filterCitizensFunc} from './filterCitizensFunc';\n\n\nconst legendStyles = {\n  root: {\n    display: 'flex',\n    margin: 'auto',\n    flexDirection: 'row',\n  },\n};\nconst legendLabelStyles = theme => ({\n  label: {\n    paddingTop: theme.spacing(1),\n  },\n});\nconst legendItemStyles = {\n  item: {\n    flexDirection: 'column',\n  },\n};\n\nconst LegendRootBase = ({ classes, ...restProps }) => (\n  <Legend.Root {...restProps} className={classes.root} />\n);\nconst LegendLabelBase = ({ classes, ...restProps }) => (\n  <Legend.Label {...restProps} className={classes.label} />\n);\nconst LegendItemBase = ({ classes, ...restProps }) => (\n  <Legend.Item {...restProps} className={classes.item} />\n);\nconst LegendRoot = withStyles(legendStyles, { name: 'LegendRoot' })(LegendRootBase);\nconst LegendLabel = withStyles(legendLabelStyles, { name: 'LegendLabel' })(LegendLabelBase);\nconst LegendItem = withStyles(legendItemStyles, { name: 'LegendItem' })(LegendItemBase);\n\nconst Label = ({ text, ...props }) => (\n  <ValueAxis.Label {...props} text={`${Math.abs(text)}%`} />\n);\nconst modifyDomain = ([start, end]) => {\n  const threshold = Math.ceil(Math.max(Math.abs(start), Math.abs(end)));\n  return [-threshold, threshold];\n};\nclass NewPyramid extends React.PureComponent {\n    constructor(props) {\n        super(props);\n        this.state = {\n            data: [],\n            year: \"2019\",\n        };\n    }\n    \n    componentDidMount(){\n        const { citizens, filterListAnalysis } = this.props;\n        const result = filterListAnalysis.length > 0 \n        ? this.caculateData(this.filterCitizensFunc(citizens, filterListAnalysis), this.state.year) \n        : this.caculateData(citizens, this.state.year);\n        this.setState({\n            ...this.state,\n            data: [...result]\n        });\n    }\n    componentDidUpdate(prevProps){\n        if(prevProps.citizens != this.props.citizens || prevProps.filterListAnalysis != this.props.filterListAnalysis){\n            const result = this.props.filterListAnalysis.length > 0 \n            ? this.caculateData(this.filterCitizensFunc(this.props.citizens, this.props.filterListAnalysis), this.state.year) \n            : this.caculateData(this.props.citizens, this.state.year);\n            this.setState({\n            ...this.state,\n            data: [...result]\n        });\n        }\n    }\n    handleChange = (e) => {\n        this.setState({\n            ...this.state,\n            year: e.target.value\n        })\n    }\n\n    handleClick = () => {\n        const { citizens, filterListAnalysis } = this.props;\n        const result = filterListAnalysis.length > 0 \n        ? this.caculateData(this.filterCitizensFunc(citizens, filterListAnalysis), this.state.year) \n        : this.caculateData(citizens, this.state.year);\n        this.setState({\n            ...this.state,\n            data: [...result]\n        });\n    }\n\n    extractCitizensByAge = (citizens, from, to, year) => {\n        let a =  citizens.filter(element => {\n            return year - element.dob.slice(0,4) >= from && year - element.dob.slice(0, 4) <= to;  \n        });\n        let countBoys = 0;\n        let countGirls = 0;\n        a.forEach(element => {\n            element.gender === \"male\" ? countBoys++ : countGirls++; \n        })\n        return {\n            age: `${from}-${to}`,\n            male: countBoys*-1/5,\n            female: countGirls/5\n        }\n    }\n    caculateData = (citizens, year) => {\n        let result = [];\n        for (let i = 0 ; i<90 ; i=i + 5){\n            let element = this.extractCitizensByAge(citizens, i, i+4, year);\n            result.push(element);\n        }\n        return result;\n    }\n    filterCitizensFunc = (citizens, filterListAnalysis) => {\n        let filteredCitizens = [];\n            let filterListId = filterListAnalysis.map(e => e.id);\n            filteredCitizens = citizens.filter(e => {\n                for(let i = 0 ; i<filterListId.length ; i++){\n                    if(e.village_id.search(filterListId[i]) !== -1){\n                        return true;\n                    }\n                }\n            });\n        return filteredCitizens;\n    }\n\n    render() {\n        const { data, year } = this.state;\n\n        return (\n        <div>\n                <Paper style={{height: \"567px\"}}>\n                    <Chart\n                    style={{height: \"100%\"}}\n                    data={data}\n                    rotated\n                    >\n                    <ArgumentScale factory={scaleBand} />\n                    <ArgumentAxis />\n                    <ValueScale modifyDomain={modifyDomain} />\n\n                    <BarSeries\n                        name=\"Nam\"\n                        valueField=\"male\"\n                        argumentField=\"age\"\n                        color=\"#3F7FBF\"\n                    />\n                    <BarSeries\n                        name=\"Nữ\"\n                        valueField=\"female\"\n                        argumentField=\"age\"\n                        color=\"#F87CCC\"\n                    />\n                    <Title text=\"Tháp dân số\" />\n                    <Animation />\n                    <Legend\n                        position=\"bottom\"\n                        rootComponent={LegendRoot}\n                        itemComponent={LegendItem}\n                        labelComponent={LegendLabel}\n                    />\n                    </Chart>\n                </Paper>\n                <div style={styles.year}>\n                    <TextField id=\"standard-basic\" label=\"Nhập năm\" variant=\"outlined\" size={\"small\"} onChange={this.handleChange} value={year} />\n                    <Button onClick={this.handleClick} variant=\"contained\">Phân tích</Button>\n                </div>\n        </div>\n    );\n  }\n}\nconst mapStatesToProps = (state) => {\n    return { \n        citizens: state.citizens.citizens,\n        filterListAnalysis: state.citizens.filterListAnalysis\n    };\n}\nexport default connect(mapStatesToProps, null)(NewPyramid);\nconst styles = {\n    year: {\n        display: \"flex\",\n        justifyContent: \"center\",\n        background: \"white\",\n        gap: \"1rem\",\n        paddingBottom: \"1rem\",\n        borderBottomLeftRadius: \"10px\",\n        borderBottomRightRadius: \"10px\"\n    }\n}\nconst data = [{\n    age: '0-4',\n    male: -4.9,\n    female: 4.3,\n  }, {\n    age: '5-9',\n    male: -4.4,\n    female: 4.2,\n  }, {\n    age: '10-14',\n    male: -4.2,\n    female: 4.0,\n  }, {\n    age: '15-19',\n    male: -4.0,\n    female: 3.8,\n  }, {\n    age: '20-24',\n    male: -3.9,\n    female: 3.7,\n  }, {\n    age: '25-29',\n    male: -4.0,\n    female: 3.8,\n  }, {\n    age: '30-34',\n    male: -4.0,\n    female: 3.8,\n  }, {\n    age: '35-39',\n    male: -3.5,\n    female: 3.4,\n  }, {\n    age: '40-44',\n    male: -3.2,\n    female: 3.1,\n  }, {\n    age: '45-49',\n    male: -3.1,\n    female: 3.1,\n  }, {\n    age: '50-54',\n    male: -2.8,\n    female: 2.8,\n  }, {\n    age: '55-59',\n    male: -2.4,\n    female: 2.5,\n  }, {\n    age: '60-64',\n    male: -2.0,\n    female: 2.1,\n  }, {\n    age: '65-69',\n    male: -1.6,\n    female: 1.8,\n  }, {\n    age: '70-74',\n    male: -1.1,\n    female: 1.2,\n  }, {\n    age: '75-79',\n    male: -0.7,\n    female: 0.9,\n  }, {\n    age: '80-84',\n    male: -0.4,\n    female: 0.6,\n  }, {\n    age: '85-89',\n    male: -0.2,\n    female: 0.3,\n  }, {\n    age: '90+',\n    male: -0.1,\n    female: 0.1,\n  }];"]},"metadata":{},"sourceType":"module"}