{"ast":null,"code":"var _jsxFileName = \"/Users/nguyenhuuan/Documents/GitHub/final-web-assignment/src/views/agency/AgencyForm.js\",\n    _s = $RefreshSig$();\n\nimport * as React from 'react';\nimport Button from '@mui/material/Button';\nimport TextField from '@mui/material/TextField';\nimport Dialog from '@mui/material/Dialog';\nimport DialogActions from '@mui/material/DialogActions';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport Box from '@mui/material/Box';\nimport InputLabel from '@mui/material/InputLabel';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { createAgency } from '../../api/apiAgencies';\nimport { appendAgency } from '../../redux/reducers/agencies/agencies.thunk';\nimport { addToast } from '../../utils';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst init = {\n  id: '',\n  name: '',\n  complated_declared: '',\n  staff: {\n    username: '',\n    password: '',\n    operate_from: null,\n    operate_to: null\n  },\n  error: {}\n};\nlet clicked = false;\n\nconst validate = (data, username) => {\n  let error = {};\n  const id_reg = RegExp(`^${username}[0-9][0-9]`); // console.log(id_reg)\n\n  if (!id_reg.test(data.id)) {\n    // alert(\"True\")\n    error.id = [`Mã đơn vị phải có dạng '${username}xx' ví dụ: '${username}02'`];\n  }\n\n  if (data.name.trim().length <= 3) {\n    error.name = ['Tên cần ít nhất 4 ký tự'];\n  }\n\n  if (data.staff.password.trim().length < 3) {\n    error.staff = {\n      password: ['Password cần ít nhất 3 ký tự']\n    };\n  }\n\n  return error;\n};\n\nexport default function AgencyForm({\n  label,\n  action,\n  initData = init\n}) {\n  _s();\n\n  const dispatch = useDispatch();\n  const [open, setOpen] = React.useState(false);\n  const currentUser = useSelector(state => state.user.currentUser);\n\n  if (!initData.id) {\n    initData.id = currentUser.username;\n    initData.staff.username = currentUser.username;\n  }\n\n  const [data, setData] = React.useState(initData);\n\n  const onSubmit = () => {\n    if (clicked) {\n      console.log(\"return\");\n      return;\n    }\n\n    clicked = true;\n    let err = validate(data, currentUser.username);\n\n    if (Object.keys(err).length === 0) {\n      (async () => {\n        try {\n          console.log(data);\n          let res = await createAgency(data);\n          console.log(res);\n\n          if (res.status === 201) {\n            // console.log(res.data)\n            addToast({\n              type: 'success',\n              title: 'Xong!',\n              message: `Đã thêm ${res.data.name}`,\n              duration: 5000\n            });\n            dispatch(appendAgency(res.data));\n            setData({ ...initData,\n              id: currentUser.username,\n              staff: { ...initData.staff,\n                username: currentUser.username\n              }\n            });\n          } else if (res.status === 400) {\n            // console.log(res.data)\n            setData({ ...data,\n              error: res.data\n            });\n          }\n\n          clicked = false;\n        } catch (error) {\n          clicked = false;\n          addToast({\n            type: 'error',\n            title: 'Lỗi!',\n            message: `Không thể thực hiện.`,\n            duration: 5000\n          });\n        }\n      })();\n    } else {\n      clicked = false;\n      setData({ ...data,\n        error: err\n      });\n    }\n  };\n\n  const handleChange = e => {\n    const l = currentUser.username.length; // const reg = `/^[0-9]{${l},${l + 2}}$/`;\n\n    let {\n      name,\n      value\n    } = e.target;\n\n    if (name === 'id') {\n      if (!isNaN(value) && value.length >= l && value.length <= l + 2) {\n        setData({ ...data,\n          id: value\n        });\n      }\n    } else if (name === 'name') {\n      setData({ ...data,\n        name: value\n      });\n    } else {\n      let staff = { ...data.staff,\n        [name]: value\n      };\n      setData({ ...data,\n        staff: staff\n      });\n    }\n  };\n\n  const handleClickOpen = () => {\n    setOpen(true);\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Button, {\n      variant: \"outlined\",\n      onClick: handleClickOpen,\n      children: \"Th\\xEAm \\u0111\\u01A1n v\\u1ECB\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n      open: open,\n      onClose: handleClose,\n      children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n        children: label\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n        children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n          children: \"Th\\xF4ng tin v\\u1EC1 \\u0111\\u01A1n v\\u1ECB\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          component: \"form\",\n          sx: {\n            '& > :not(style)': {\n              m: 1,\n              width: '25ch'\n            }\n          } // noValidate\n          ,\n          autoComplete: \"off\",\n          children: [/*#__PURE__*/_jsxDEV(TextField, {\n            error: typeof data.error.id !== 'undefined',\n            helperText: data.error.id ? data.error.id[0] : '',\n            onChange: handleChange,\n            autoFocus: true,\n            margin: \"dense\",\n            id: \"id\",\n            label: \"M\\xE3 \\u0111\\u01A1n v\\u1ECB\",\n            type: \"text\",\n            name: \"id\",\n            fullWidth: true,\n            variant: \"outlined\",\n            size: \"small\",\n            value: data.id\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            onChange: handleChange,\n            error: typeof data.error.name !== 'undefined',\n            helperText: data.error.name ? data.error.name[0] : '',\n            margin: \"dense\",\n            id: \"name\",\n            name: \"name\",\n            label: \"T\\xEAn \\u0111\\u01A1n v\\u1ECB\",\n            type: \"text\",\n            fullWidth: true,\n            variant: \"outlined\",\n            size: \"small\",\n            value: data.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(InputLabel, {\n          children: \"Th\\xF4ng tin t\\xE0i kho\\u1EA3n\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          component: \"form\",\n          sx: {\n            '& > :not(style)': {\n              m: 1,\n              width: '25ch'\n            }\n          } // noValidate\n          ,\n          autoComplete: \"off\",\n          children: [/*#__PURE__*/_jsxDEV(TextField, {\n            onChange: handleChange,\n            disabled: true,\n            margin: \"dense\",\n            id: \"username\",\n            name: \"username\",\n            label: \"T\\xEAn \\u0111\\u0103ng nh\\u1EADp\",\n            type: \"email\",\n            variant: \"outlined\",\n            size: \"small\",\n            value: data.id\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            error: data.error.staff && typeof data.error.staff.password !== 'undefined',\n            helperText: data.error.staff && data.error.staff.password ? data.error.staff.password[0] : '',\n            onChange: handleChange,\n            margin: \"dense\",\n            id: \"pasword\",\n            name: \"password\",\n            label: \"M\\u1EADt kh\\u1EA9u\",\n            type: \"text\" // fullWidth\n            ,\n            variant: \"outlined\",\n            size: \"small\",\n            value: data.staff.password\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleClose,\n          children: \"H\\u1EE7y\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"contained\",\n          onClick: onSubmit,\n          children: \"L\\u01B0u\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 150,\n    columnNumber: 5\n  }, this);\n}\n\n_s(AgencyForm, \"JG0Yp2ehiEf1BNrvsoE18avizwg=\", false, function () {\n  return [useDispatch, useSelector];\n});\n\n_c = AgencyForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"AgencyForm\");","map":{"version":3,"sources":["/Users/nguyenhuuan/Documents/GitHub/final-web-assignment/src/views/agency/AgencyForm.js"],"names":["React","Button","TextField","Dialog","DialogActions","DialogContent","DialogTitle","Box","InputLabel","useSelector","useDispatch","createAgency","appendAgency","addToast","init","id","name","complated_declared","staff","username","password","operate_from","operate_to","error","clicked","validate","data","id_reg","RegExp","test","trim","length","AgencyForm","label","action","initData","dispatch","open","setOpen","useState","currentUser","state","user","setData","onSubmit","console","log","err","Object","keys","res","status","type","title","message","duration","handleChange","e","l","value","target","isNaN","handleClickOpen","handleClose","m","width"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport Button from '@mui/material/Button';\nimport TextField from '@mui/material/TextField';\nimport Dialog from '@mui/material/Dialog';\nimport DialogActions from '@mui/material/DialogActions';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport Box from '@mui/material/Box';\nimport InputLabel from '@mui/material/InputLabel';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { createAgency } from '../../api/apiAgencies';\n\nimport { appendAgency } from '../../redux/reducers/agencies/agencies.thunk';\nimport {addToast} from '../../utils'\n\nconst init = {\n  id:'',\n  name: '',\n  complated_declared: '',\n  staff: {\n    username: '',\n    password: '',\n    operate_from: null,\n    operate_to: null,\n  },\n  error: {}\n}\n\nlet clicked = false\nconst validate = (data, username) => {\n  let error = {}\n  const id_reg = RegExp(`^${username}[0-9][0-9]`)\n  // console.log(id_reg)\n  if(!id_reg.test(data.id)) {\n    // alert(\"True\")\n    error.id = [`Mã đơn vị phải có dạng '${username}xx' ví dụ: '${username}02'`]\n  } \n  if (data.name.trim().length <= 3) {\n    error.name = ['Tên cần ít nhất 4 ký tự']\n  }\n  if (data.staff.password.trim().length < 3) {\n    error.staff = {password:['Password cần ít nhất 3 ký tự']}\n  }\n  return error\n}\n\nexport default function AgencyForm({label, action, initData=init}) {\n  const dispatch = useDispatch()\n\n  const [open, setOpen] = React.useState(false)\n  const currentUser = useSelector(state => state.user.currentUser)\n  if (!initData.id) {\n    initData.id = currentUser.username;\n    initData.staff.username = currentUser.username;\n  }\n\n  const [data, setData] = React.useState(initData)\n  \n  const onSubmit = () => {\n    if (clicked) {\n      console.log(\"return\")\n      return \n    }\n    clicked = true\n    let err = validate(data, currentUser.username)\n    if(Object.keys(err).length === 0) {\n      (async () => {\n        try {\n          console.log(data)\n          let res = await createAgency(data)\n          console.log(res)\n          if (res.status === 201) {\n              // console.log(res.data)\n              addToast({\n                type:'success', \n                title:'Xong!', \n                message:`Đã thêm ${res.data.name}`, \n                duration: 5000\n              })\n              dispatch(appendAgency(res.data))\n              setData({\n                ...initData,\n                id: currentUser.username,\n                staff: {\n                  ...initData.staff,\n                  username: currentUser.username,              \n                }\n              })\n          } else if (res.status === 400) {\n            // console.log(res.data)\n            setData({\n              ...data,\n              error: res.data\n            })\n          }\n          clicked = false\n        } catch (error) {\n          clicked = false\n          addToast({\n            type:'error', \n            title:'Lỗi!', \n            message:`Không thể thực hiện.`, \n            duration: 5000\n          })\n        }\n      })()\n    } else {\n      clicked = false\n      setData({\n        ...data,\n        error: err\n      })\n    }\n  }\n  const handleChange = (e) => {\n    const l = currentUser.username.length\n    // const reg = `/^[0-9]{${l},${l + 2}}$/`;\n    let {name, value} = e.target;\n    if (name ==='id') {\n      if (!isNaN(value) && value.length >= l && value.length <= l + 2) {\n        setData({\n          ...data,\n          id:value\n        }) \n      }     \n    } else if(name === 'name'){\n      setData({\n        ...data,\n        name: value\n      })\n    }else {\n      let staff = {...data.staff, [name]: value}\n      setData({\n        ...data,\n        staff: staff\n      })\n    }\n  }\n  const handleClickOpen = () => {\n    setOpen(true);\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n\n\n  return (\n    <div>\n      <Button variant=\"outlined\" onClick={handleClickOpen}>\n        Thêm đơn vị\n      </Button>\n      <Dialog open={open} onClose={handleClose}>\n        <DialogTitle>{label}</DialogTitle>\n        <DialogContent>\n          \n          <InputLabel>Thông tin về đơn vị</InputLabel>\n          <Box\n            component=\"form\"\n            sx={{\n              '& > :not(style)': { m: 1, width: '25ch' },\n            }}\n            // noValidate\n            autoComplete=\"off\"\n          >\n            <TextField\n              error= {typeof data.error.id !== 'undefined'}\n              helperText = {data.error.id? data.error.id[0]:''}\n              onChange={handleChange} \n              autoFocus\n              margin=\"dense\"\n              id=\"id\"\n              label=\"Mã đơn vị\"\n              type=\"text\"\n              name=\"id\"\n              fullWidth\n              variant=\"outlined\"\n              size=\"small\"\n              value={data.id}\n            />\n          <TextField\n            onChange={handleChange} \n            error= {typeof data.error.name !== 'undefined'}\n            helperText = {data.error.name? data.error.name[0]:''}\n            margin=\"dense\"\n            id=\"name\"\n            name=\"name\"\n            label=\"Tên đơn vị\"\n            type=\"text\"\n            fullWidth\n            variant=\"outlined\"\n            size=\"small\"\n            value={data.name}\n          />\n          </Box>\n          <InputLabel>Thông tin tài khoản</InputLabel>\n          <Box\n            component=\"form\"\n            sx={{\n              '& > :not(style)': { m: 1, width: '25ch' },\n            }}\n            // noValidate\n            autoComplete=\"off\"\n          >\n            <TextField\n              onChange={handleChange} \n              disabled\n              margin=\"dense\"\n              id=\"username\"\n              name=\"username\"\n              label=\"Tên đăng nhập\"\n              type=\"email\"\n              \n              variant=\"outlined\"\n              size=\"small\"\n              value={data.id}\n            />\n            <TextField\n              error= {data.error.staff && typeof data.error.staff.password !== 'undefined'}\n              helperText = {data.error.staff && data.error.staff.password? data.error.staff.password[0]:''}\n              onChange={handleChange} \n              margin=\"dense\"\n              id=\"pasword\"\n              name=\"password\"\n              label=\"Mật khẩu\"\n              type=\"text\"\n              // fullWidth\n              variant=\"outlined\"\n              size=\"small\"\n              value={data.staff.password}\n            />\n          </Box>\n          \n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleClose}>Hủy</Button>\n          <Button variant=\"contained\" onClick={onSubmit}>Lưu</Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}